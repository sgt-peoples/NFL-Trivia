<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>NFL Sicko Trivia</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <style>
    :root {
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
      color-scheme: dark;
    }

    body {
      margin: 0;
      padding: 0;
      background: #05060a;
      color: #f5f5f5;
      display: flex;
      justify-content: center;
      align-items: flex-start;
      min-height: 100vh;
    }

    .app {
      width: 100%;
      max-width: 480px;
      padding: 16px 12px 40px;
      box-sizing: border-box;
    }

    .top-bar {
      width: 100%;
      box-sizing: border-box;
      padding: 10px 12px;
      margin-bottom: 12px;
      border-radius: 999px;
      background: #141623;
      border: 1px solid #272a3c;
      font-size: 0.9rem;
      text-align: center;
      font-weight: 600;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }

    .card {
      background: #11131d;
      border-radius: 16px;
      padding: 16px 14px 20px;
      box-shadow: 0 10px 25px rgba(0, 0, 0, 0.4);
      border: 1px solid #23263a;
    }

    .center {
      text-align: center;
    }

    .h1 {
      font-size: 1.3rem;
      margin-bottom: 8px;
      font-weight: 700;
    }

    .subtle {
      font-size: 0.9rem;
      color: #9ca3af;
      margin-bottom: 4px;
    }

    .categories {
      font-size: 0.9rem;
      line-height: 1.5;
      margin: 12px 0 20px;
    }

    .btn {
      display: inline-flex;
      align-items: center;
      justify-content: center;
      padding: 10px 14px;
      border-radius: 999px;
      border: none;
      font-size: 1rem;
      font-weight: 600;
      cursor: pointer;
      width: 100%;
      margin-top: 8px;
      transition: transform 0.06s ease, box-shadow 0.06s ease, background 0.15s;
      outline: none;
    }

    .btn-primary {
      background: #2563eb;
      color: #f9fafb;
      box-shadow: 0 8px 18px rgba(37, 99, 235, 0.45);
    }

    .btn-primary:active {
      transform: translateY(1px);
      box-shadow: 0 3px 10px rgba(37, 99, 235, 0.4);
    }

    .btn-secondary {
      background: #1f2937;
      color: #e5e7eb;
      box-shadow: 0 6px 14px rgba(15, 23, 42, 0.5);
    }

    .btn-secondary:active {
      transform: translateY(1px);
      box-shadow: 0 2px 8px rgba(15, 23, 42, 0.6);
    }

    .btn-inline {
      width: auto;
      padding-inline: 12px;
      font-size: 0.85rem;
      margin-top: 0;
    }

    .hint-line {
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 8px;
      margin-bottom: 8px;
      font-size: 0.85rem;
    }

    .hint-text {
      flex: 1;
      min-height: 1.2em;
      color: #9ca3af;
      font-style: italic;
    }

    .question-text {
      font-size: 1.1rem;
      line-height: 1.4;
      margin: 8px 0 10px;
    }

    .answer-box {
      margin-top: 6px;
      padding: 10px 8px;
      border-radius: 12px;
      background: #020617;
      border: 1px dashed #374151;
      text-align: center;
      min-height: 3.5em;
    }

    .answer-hidden {
      font-size: 0.9rem;
      color: #6b7280;
    }

    .answer-revealed {
      font-size: clamp(1.8rem, 5vw, 2.5rem);
      font-weight: 800;
      letter-spacing: 0.03em;
      text-transform: uppercase;
      color: #fbbf24;
    }

    .controls-row {
      display: flex;
      justify-content: center;
      gap: 10px;
      margin-top: 12px;
    }

    .judge-btn {
      flex: 1;
      height: 52px;
      border-radius: 16px;
      border: none;
      cursor: pointer;
      font-size: 1.5rem;
      font-weight: 800;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: transform 0.06s ease, box-shadow 0.06s ease, background 0.1s;
    }

    .judge-correct {
      background: #16a34a;
      color: #ecfdf5;
      box-shadow: 0 8px 16px rgba(22, 163, 74, 0.5);
    }

    .judge-wrong {
      background: #b91c1c;
      color: #fee2e2;
      box-shadow: 0 8px 16px rgba(185, 28, 28, 0.5);
    }

    .judge-btn:active {
      transform: translateY(1px);
      box-shadow: 0 3px 8px rgba(0, 0, 0, 0.6);
    }

    .nav-row {
      display: flex;
      justify-content: space-between;
      margin-top: 10px;
      font-size: 0.85rem;
      color: #9ca3af;
    }

    .nav-link {
      cursor: pointer;
      padding: 4px 6px;
      border-radius: 999px;
      user-select: none;
    }

    .nav-link:hover {
      background: #111827;
    }

    .small-label {
      font-size: 0.85rem;
      color: #9ca3af;
      margin-top: 6px;
      text-align: center;
    }

    .final-screen {
      text-align: center;
    }

    .final-title {
      font-size: 1.6rem;
      margin-bottom: 8px;
      font-weight: 800;
    }

    .final-score {
      font-size: 1.2rem;
      margin-bottom: 8px;
    }

    .final-note {
      font-size: 0.95rem;
      color: #9ca3af;
      margin-bottom: 14px;
    }

    .tagline {
      font-size: 0.8rem;
      color: #6b7280;
      margin-top: 10px;
    }

    /* Confetti */
    .confetti-container {
      position: fixed;
      inset: 0;
      pointer-events: none;
      overflow: hidden;
      z-index: 999;
    }

    .confetti-piece {
      position: absolute;
      width: 8px;
      height: 14px;
      background: #f97316;
      opacity: 0.9;
      animation: confetti-fall 1.8s linear forwards;
    }

    @keyframes confetti-fall {
      0% {
        transform: translateY(-10vh) rotateZ(0deg);
      }
      100% {
        transform: translateY(110vh) rotateZ(360deg);
      }
    }
  </style>
</head>
<body>
  <div class="confetti-container" id="confetti"></div>

  <div class="app">
    <div class="top-bar" id="topBar">
      NFL Sicko Trivia â€¢ 0/0 correct (0%) â€¢ Q 0/50
    </div>

    <div class="card" id="card">
      <!-- Landing screen goes here initially -->
      <div id="landing">
        <div class="center">
          <div class="h1">NFL Sicko Trivia</div>
          <div class="subtle">Difficulty Mix for This Deck</div>
          <div class="categories">
            ðŸ”¥ 25â€“30 questions â€” <strong>Records &amp; Freak Stats</strong><br />
            ðŸ”¥ 15â€“20 questions â€” <strong>Sicko-Level Player Knowledge</strong><br />
            ðŸ”¥ 3 questions â€” <strong>Coach's Corner</strong><br />
            ðŸ”¥ 2â€“3 questions â€” <strong>Deeeep Cuts</strong>
          </div>
          <button class="btn btn-primary" id="startBtn">
            Start Trivia
          </button>
          <div class="tagline">
            Designed to make 8 grown men argue about football.
          </div>
        </div>
      </div>
    </div>
  </div>

  <script src="questions.js"></script>
  <script>
    // --- State ---
    let deck = []; // shuffled copy of QUESTIONS
    let currentIndex = 0;
    let correctCount = 0;
    let attemptedCount = 0;
    let answersShown = false;
    // 'correct' | 'wrong' | null for each question
    let results = [];

    const topBar = document.getElementById("topBar");
    const card = document.getElementById("card");
    const confettiContainer = document.getElementById("confetti");
    const landing = document.getElementById("landing");
    const startBtn = document.getElementById("startBtn");

    // Simple Fisher-Yates shuffle
    function shuffleArray(arr) {
      const a = arr.slice();
      for (let i = a.length - 1; i > 0; i--) {
        const j = Math.floor(Math.random() * (i + 1));
        [a[i], a[j]] = [a[j], a[i]];
      }
      return a;
    }

    function formatPercent(n) {
      if (!Number.isFinite(n)) return "0%";
      return `${Math.round(n)}%`;
    }

    function updateTopBar() {
      const total = deck.length;
      const percent = attemptedCount > 0 ? (correctCount / attemptedCount) * 100 : 0;
      topBar.textContent =
        `NFL Sicko Trivia â€¢ ${correctCount}/${attemptedCount} correct (${formatPercent(percent)}) â€¢ Q ${currentIndex + 1}/${total}`;
    }

    function renderQuestion() {
      const total = deck.length;
      const q = deck[currentIndex];

      const answered = results[currentIndex]; // 'correct' | 'wrong' | null

      card.innerHTML = "";

      const wrap = document.createElement("div");

      // Hint line
      const hintLine = document.createElement("div");
      hintLine.className = "hint-line";

      const hintText = document.createElement("div");
      hintText.className = "hint-text";
      hintText.id = "hintText";
      hintText.textContent = "";

      const hintBtn = document.createElement("button");
      hintBtn.className = "btn btn-secondary btn-inline";
      hintBtn.textContent = "Hint";
      hintBtn.onclick = () => {
        hintText.textContent = q.hint || "No hint for this one.";
      };

      hintLine.appendChild(hintText);
      hintLine.appendChild(hintBtn);

      // Question text
      const qDiv = document.createElement("div");
      qDiv.className = "question-text";
      qDiv.textContent = q.q;

      // Answer box
      const ansBox = document.createElement("div");
      ansBox.className = "answer-box";

      const ansInner = document.createElement("div");
      ansInner.id = "answerText";

      if (answersShown) {
        ansInner.className = "answer-revealed";
        ansInner.textContent = q.a;
      } else {
        ansInner.className = "answer-hidden";
        ansInner.textContent = "Tap â€œShow Answerâ€ when youâ€™re ready.";
      }

      ansBox.appendChild(ansInner);

      // Show answer button
      const revealBtn = document.createElement("button");
      revealBtn.className = "btn btn-secondary";
      revealBtn.textContent = answersShown ? "Hide Answer" : "Show Answer";
      revealBtn.onclick = () => {
        answersShown = !answersShown;
        renderQuestion();
      };

      // Correct / Wrong buttons
      const controlsRow = document.createElement("div");
      controlsRow.className = "controls-row";

      const correctBtn = document.createElement("button");
      correctBtn.className = "judge-btn judge-correct";
      correctBtn.textContent = "âœ”";
      correctBtn.title = "We got it right";

      const wrongBtn = document.createElement("button");
      wrongBtn.className = "judge-btn judge-wrong";
      wrongBtn.textContent = "âœ–";
      wrongBtn.title = "We got it wrong";

      correctBtn.onclick = () => handleJudge("correct");
      wrongBtn.onclick = () => handleJudge("wrong");

      controlsRow.appendChild(correctBtn);
      controlsRow.appendChild(wrongBtn);

      // Nav row for fixing mistakes
      const navRow = document.createElement("div");
      navRow.className = "nav-row";

      const prev = document.createElement("span");
      prev.className = "nav-link";
      prev.textContent = currentIndex > 0 ? "â—€ Prev" : "";
      prev.onclick = () => {
        if (currentIndex > 0) {
          currentIndex -= 1;
          answersShown = false;
          renderQuestion();
        }
      };

      const info = document.createElement("span");
      info.textContent = `Question ${currentIndex + 1} of ${total}`;

      const next = document.createElement("span");
      next.className = "nav-link";
      next.textContent = currentIndex < total - 1 ? "Next â–¶" : "";
      next.onclick = () => {
        if (currentIndex < total - 1) {
          currentIndex += 1;
          answersShown = false;
          renderQuestion();
        }
      };

      navRow.appendChild(prev);
      navRow.appendChild(info);
      navRow.appendChild(next);

      // Small label
      const label = document.createElement("div");
      label.className = "small-label";
      label.textContent = "Tap âœ” or âœ– after your group answers. You can use â—€ / â–¶ to fix mistakes.";

      wrap.appendChild(hintLine);
      wrap.appendChild(qDiv);
      wrap.appendChild(ansBox);
      wrap.appendChild(revealBtn);
      wrap.appendChild(controlsRow);
      wrap.appendChild(navRow);
      wrap.appendChild(label);

      card.appendChild(wrap);
      updateTopBar();
    }

    function handleJudge(value) {
      const prevValue = results[currentIndex]; // may be 'correct'/'wrong'/null

      // Adjust counters based on previous value
      if (!prevValue) {
        attemptedCount += 1;
      } else {
        if (prevValue === "correct") {
          correctCount -= 1;
        }
      }

      if (value === "correct") {
        correctCount += 1;
        results[currentIndex] = "correct";
      } else {
        results[currentIndex] = "wrong";
      }

      updateTopBar();

      // Move to next unanswered if possible, else next sequential, else end.
      const total = deck.length;
      let nextIndex = currentIndex + 1;

      // If not last, just go next
      if (nextIndex < total) {
        currentIndex = nextIndex;
        answersShown = false;
        renderQuestion();
        maybeFinish();
        return;
      }

      // If last, check if all attempted
      maybeFinish();
    }

    function maybeFinish() {
      const total = deck.length;
      const allAttempted = results.filter(r => r === "correct" || r === "wrong").length === total;
      if (allAttempted) {
        showFinalScreen();
      }
    }

    function fireConfetti() {
      confettiContainer.innerHTML = "";
      const colors = ["#f97316", "#22c55e", "#3b82f6", "#eab308", "#ec4899", "#a855f7"];
      const pieces = 120;

      for (let i = 0; i < pieces; i++) {
        const piece = document.createElement("div");
        piece.className = "confetti-piece";
        piece.style.left = Math.random() * 100 + "vw";
        piece.style.background = colors[Math.floor(Math.random() * colors.length)];
        piece.style.animationDelay = (Math.random() * 0.5) + "s";
        piece.style.opacity = (0.6 + Math.random() * 0.4).toFixed(2);
        confettiContainer.appendChild(piece);
      }

      setTimeout(() => {
        confettiContainer.innerHTML = "";
      }, 2500);
    }

    function showFinalScreen() {
      const total = deck.length;
      const percent = total > 0 ? (correctCount / total) * 100 : 0;
      let title;
      let note;

      if (percent === 100) {
        title = "100% â€” Absolute Sickos.";
        note = "You got everything. Seek help. (In a good way.)";
      } else if (percent >= 80) {
        title = `${Math.round(percent)}% â€” Elite NFL Brain.`;
        note = "You belong in a film room, not on vacation.";
      } else if (percent >= 60) {
        title = `${Math.round(percent)}% â€” Respectable Grind.`;
        note = "Solid showing. A few bad beats, but you held your own.";
      } else {
        title = `${Math.round(percent)}% â€” Practice Squad.`;
        note = "Fun was had. Thatâ€™s what matters. Probably.";
      }

      if (percent >= 80) {
        fireConfetti();
      }

      card.innerHTML = "";
      const wrap = document.createElement("div");
      wrap.className = "final-screen";

      const t = document.createElement("div");
      t.className = "final-title";
      t.textContent = title;

      const s = document.createElement("div");
      s.className = "final-score";
      s.textContent = `Correct: ${correctCount}/${total} (${formatPercent(percent)})`;

      const n = document.createElement("div");
      n.className = "final-note";
      n.textContent = note;

      const btn = document.createElement("button");
      btn.className = "btn btn-primary";
      btn.textContent = "Play Again (New Order)";
      btn.onclick = () => {
        startGame(true);
      };

      const tag = document.createElement("div");
      tag.className = "tagline";
      tag.textContent = "Reload the page if you just want to stare at your shame.";

      wrap.appendChild(t);
      wrap.appendChild(s);
      wrap.appendChild(n);
      wrap.appendChild(btn);
      wrap.appendChild(tag);

      card.appendChild(wrap);
      updateTopBar();
    }

    function startGame(fromReplay = false) {
      // Make a shuffled copy of QUESTIONS
      deck = shuffleArray(QUESTIONS);
      currentIndex = 0;
      correctCount = 0;
      attemptedCount = 0;
      answersShown = false;
      results = new Array(deck.length).fill(null);

      // Remove landing screen if first time
      if (!fromReplay && landing) {
        landing.remove();
      }

      renderQuestion();
    }

    startBtn.addEventListener("click", () => startGame(false));
  </script>
</body>
</html>
